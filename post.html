<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<link href="http://7xifrq.com1.z0.glb.clouddn.com/bootstrap/css/bootstrap.min.css" rel="stylesheet">
<title>写文章</title>
</head>
<body>
	<div class="container-fluid">
		<div class="row">
			<div class="col-xs-6 col-md-9" style="padding: 0px">
				<input class="form-control" type="text" placeholder="标题" id="title">
			</div>
			<input class="col-xs-2 col-md-1 btn btn-default" type="button" value="清除" id="reset"> <input
				class="col-xs-2 col-md-1 btn btn-default" type="button" value="预览" id="preview"> <input
				class="col-xs-2 col-md-1 btn btn-default" type="button" value="发表" id="submit">
		</div>
	</div>
	<div id="epiceditor"></div>
</body>
<script type="text/javascript" src="http://7xifrq.com1.z0.glb.clouddn.com/common/tools.js"></script>
<script type="text/javascript" src="http://7xifrq.com1.z0.glb.clouddn.com/jquery.min.js"></script>
<script type="text/javascript" src="http://7xifrq.com1.z0.glb.clouddn.com/bootstrap/js/bootstrap.min.js"></script>
<script type="text/javascript" src="http://7xifrq.com1.z0.glb.clouddn.com/EpicEditor/js/epiceditor.min.js"></script>
<script type="text/javascript">
	var editorHeight = window.screen.availHeight / 2;
	if (isMobile.any()) {
		editorHeight = window.screen.availHeight / 7 * 3;
	}
	var opts = {
		basePath : 'http://7xifrq.com1.z0.glb.clouddn.com/EpicEditor',
		button : {
			bar : false
		},
		autogrow : {
			minHeight : editorHeight,
			maxHeight : editorHeight
		}
	}
	var editor = new EpicEditor(opts).load();
</script>
<script type="text/javascript" src="http://7xifrq.com1.z0.glb.clouddn.com/underscore-min.js"></script>
<script type="text/javascript" src="http://7xifrq.com1.z0.glb.clouddn.com/github.js"></script>
<script type="text/javascript">
	$("#submit").on(
			"click",
			function(e) {
				var github = null;
				if (localStorage.githubAct) {
					github = new Github({
						username : localStorage.githubAct.user,
						password : localStorage.githubAct.pwd,
						auth : "basic"
					});
				} else {

				}
				var repo = github.getRepo("cmanlh", "cmanlh.github.io");
				repo.write('master', 'post/md/' + Date.now() + "-" + $("#title").val() + ".md", editor.exportFile(null,
						"text", false), 'post a new blog', function(err) {
					repo.write('master', 'post/html/' + Date.now() + "-" + $("#title").val() + ".html", editor
							.exportFile(null, "html", false), 'post a new blog', function(err, data) {
						console.log(data);
					});
				});
			});
</script>
</html>